"use strict";(self.webpackChunkarco_lesscode=self.webpackChunkarco_lesscode||[]).push([[601],{"./src/components/RequestProvider/index.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k_:()=>InjectProps,LC:()=>RequestProvider});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),Spin=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Spin/index.js"),useRequest=__webpack_require__("./node_modules/.pnpm/ahooks@3.9.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/ahooks/es/useRequest/index.js"),react=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");const RequestContext=(0,react.createContext)({loading:!0}),GenericRefInner=({children,service,params={},spinning,manual,...props},ref)=>{const[innerParams,setInnerParams]=(0,react.useState)(params),KEY=(0,react.useRef)(""),Request=(0,useRequest.A)(()=>service(innerParams),{manual,refreshDeps:[JSON.stringify(innerParams),manual]}),setParams=(0,react.useCallback)((p,key)=>{KEY.current=key??"",setInnerParams(prev=>({...prev,...p})),manual&&Request.run()},[manual,Request]),refresh=(0,react.useCallback)(key=>{KEY.current=key??"",setInnerParams(prev=>({...prev,timestamp:Date.now()})),manual&&Request.run()},[manual,Request]);(0,react.useImperativeHandle)(ref,()=>({resp:Request.data,params:innerParams,setParams,refresh}),[Request.data,innerParams,setParams,refresh]);const childrenWithProps=react.Children.map(children,child=>react.isValidElement(child)?react.cloneElement(child,props):child);return(0,jsx_runtime.jsx)(RequestContext.Provider,{value:{...Request,key:KEY.current},children:spinning?(0,jsx_runtime.jsx)(Spin.A,{style:{width:"100%"},loading:Request.loading,children:childrenWithProps}):childrenWithProps})},RequestProvider=(0,react.forwardRef)(GenericRefInner);GenericRefInner.__docgenInfo={description:"",methods:[],displayName:"GenericRefInner",props:{params:{required:!1,tsType:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},description:"",defaultValue:{value:"{}",computed:!1}},children:{required:!1,tsType:{name:"ReactNode"},description:""},manual:{required:!1,tsType:{name:"boolean"},description:""},spinning:{required:!1,tsType:{name:"boolean"},description:""},service:{required:!0,tsType:{name:"signature",type:"function",raw:"(params: Partial<P>) => Promise<R>",signature:{arguments:[{type:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},name:"params"}],return:{name:"Promise",elements:[{name:"R"}],raw:"Promise<R>"}}},description:""},ref:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{\n  resp: unknown; // 上一次请求数据\n  params: Partial<P>; // 请求参数\n  setParams: (params: Partial<P>, key?: string) => void; // 更新请求参数\n  refresh: (key?: string) => void; // 强制刷新\n}",signature:{properties:[{key:"resp",value:{name:"unknown",required:!0}},{key:"params",value:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>",required:!0}},{key:"setParams",value:{name:"signature",type:"function",raw:"(params: Partial<P>, key?: string) => void",signature:{arguments:[{type:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},name:"params"},{type:{name:"string"},name:"key"}],return:{name:"void"}},required:!0}},{key:"refresh",value:{name:"signature",type:"function",raw:"(key?: string) => void",signature:{arguments:[{type:{name:"string"},name:"key"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<RequestProviderRefType<P>>"},description:""}}},RequestProvider.__docgenInfo={description:"",methods:[],displayName:"RequestProvider",props:{params:{required:!1,tsType:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},description:"",defaultValue:{value:"{}",computed:!1}},children:{required:!1,tsType:{name:"ReactNode"},description:""},manual:{required:!1,tsType:{name:"boolean"},description:""},spinning:{required:!1,tsType:{name:"boolean"},description:""},service:{required:!0,tsType:{name:"signature",type:"function",raw:"(params: Partial<P>) => Promise<R>",signature:{arguments:[{type:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},name:"params"}],return:{name:"Promise",elements:[{name:"R"}],raw:"Promise<R>"}}},description:""},ref:{required:!1,tsType:{name:"Ref",elements:[{name:"signature",type:"object",raw:"{\n  resp: unknown; // 上一次请求数据\n  params: Partial<P>; // 请求参数\n  setParams: (params: Partial<P>, key?: string) => void; // 更新请求参数\n  refresh: (key?: string) => void; // 强制刷新\n}",signature:{properties:[{key:"resp",value:{name:"unknown",required:!0}},{key:"params",value:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>",required:!0}},{key:"setParams",value:{name:"signature",type:"function",raw:"(params: Partial<P>, key?: string) => void",signature:{arguments:[{type:{name:"Partial",elements:[{name:"P"}],raw:"Partial<P>"},name:"params"},{type:{name:"string"},name:"key"}],return:{name:"void"}},required:!0}},{key:"refresh",value:{name:"signature",type:"function",raw:"(key?: string) => void",signature:{arguments:[{type:{name:"string"},name:"key"}],return:{name:"void"}},required:!0}}]}}],raw:"Ref<RequestProviderRefType<P>>"},description:""}}};const InjectProps=({schema,children,submitMode,...props})=>{const Request=(0,react.useContext)(RequestContext),injectProps=(0,react.useMemo)(()=>schema&&Request.data?Object.entries(schema).reduce((acc,[key,{dataIndex,fallback=[],format,verify=()=>!0}])=>{const rawValue=function getValueByPath(obj,path){return path.reduce((acc,key)=>null!=acc?acc[key]:void 0,obj)}(Request.data,dataIndex),value=verify(rawValue)?rawValue:fallback;return acc[key]=format?format(value):value,acc},{}):{},[schema,Request.data]);if("function"==typeof children)return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:children(injectProps)});const childrenWithNewProps=react.Children.map(children,child=>react.isValidElement(child)?react.cloneElement(child,{...props,...injectProps,loading:submitMode?props.loading:"void"===child.key||Request.key===child.key?Request.loading:0}):child);return(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children:childrenWithNewProps})};InjectProps.__docgenInfo={description:"",methods:[],displayName:"InjectProps",props:{schema:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"signature",type:"object",raw:"{\n  dataIndex: string[];\n  fallback?: unknown;\n  verify?: (resp: unknown) => boolean;\n  format?: (resp: unknown) => unknown;\n}",signature:{properties:[{key:"dataIndex",value:{name:"Array",elements:[{name:"string"}],raw:"string[]",required:!0}},{key:"fallback",value:{name:"unknown",required:!1}},{key:"verify",value:{name:"signature",type:"function",raw:"(resp: unknown) => boolean",signature:{arguments:[{type:{name:"unknown"},name:"resp"}],return:{name:"boolean"}},required:!1}},{key:"format",value:{name:"signature",type:"function",raw:"(resp: unknown) => unknown",signature:{arguments:[{type:{name:"unknown"},name:"resp"}],return:{name:"unknown"}},required:!1}}]}}],raw:"Record<string, InjectField>"},description:""},loading:{required:!1,tsType:{name:"union",raw:"boolean | number",elements:[{name:"boolean"},{name:"number"}]},description:""},submitMode:{required:!1,tsType:{name:"boolean"},description:""},children:{required:!1,tsType:{name:"union",raw:"| React.ReactElement<{ loading?: boolean | number }>\n| React.ReactElement<{ loading?: boolean | number }>[]\n| ((props: Record<string, unknown>) => React.ReactNode)",elements:[{name:"ReactReactElement",raw:"React.ReactElement<{ loading?: boolean | number }>",elements:[{name:"signature",type:"object",raw:"{ loading?: boolean | number }",signature:{properties:[{key:"loading",value:{name:"union",raw:"boolean | number",elements:[{name:"boolean"},{name:"number"}],required:!1}}]}}]},{name:"Array",elements:[{name:"ReactReactElement",raw:"React.ReactElement<{ loading?: boolean | number }>",elements:[{name:"signature",type:"object",raw:"{ loading?: boolean | number }",signature:{properties:[{key:"loading",value:{name:"union",raw:"boolean | number",elements:[{name:"boolean"},{name:"number"}],required:!1}}]}}]}],raw:"React.ReactElement<{ loading?: boolean | number }>[]"},{name:"unknown"}]},description:""}}}},"./src/libs/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>FormWrapperRender,q:()=>FromCompRender});var jsx_runtime=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/.pnpm/react@18.3.1/node_modules/react/index.js"),Grid=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Grid/index.js"),Form=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Form/index.js"),Button=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Button/index.js"),IconArrowRise=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/icon/react-icon/IconArrowRise/index.js"),IconArrowFall=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/icon/react-icon/IconArrowFall/index.js"),IconDelete=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/icon/react-icon/IconDelete/index.js"),IconPlus=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/icon/react-icon/IconPlus/index.js"),RequestProvider=__webpack_require__("./src/components/RequestProvider/index.tsx"),Input=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Input/index.js"),InputNumber=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/InputNumber/index.js"),Select=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Select/index.js"),TreeSelect=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/TreeSelect/index.js"),Radio=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Radio/index.js"),Checkbox=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Checkbox/index.js"),AutoComplete=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/AutoComplete/index.js"),DatePicker=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/DatePicker/index.js"),ColorPicker=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/ColorPicker/index.js"),Cascader=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Cascader/index.js"),Switch=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Switch/index.js"),Tabs=__webpack_require__("./node_modules/.pnpm/@arco-design+web-react@2.66.4_@types+react@19.1.10_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/@arco-design/web-react/es/Tabs/index.js");function TabsList(props){const[activeTab,setActiveTab]=(0,react.useState)("0"),{field,schemas:{properties},...tabsProps}=props,keys=Object.keys(properties),tabNameKey=props.tabNameKey||Object.keys(properties)[0]||"";return(0,jsx_runtime.jsx)(Grid.A.Col,{span:props.span||24,className:"form-list",children:(0,jsx_runtime.jsx)(Form.A.Item,{children:(0,jsx_runtime.jsx)(Form.A.List,{field,initialValue:props.value,children:(fields,{add,remove})=>(0,jsx_runtime.jsx)(Tabs.A,{editable:!0,lazyload:!1,...tabsProps,activeTab,addButton:(0,jsx_runtime.jsx)(Button.A,{size:"mini",icon:(0,jsx_runtime.jsx)(IconPlus.A,{}),style:{marginBottom:0===fields.length?"8px":"0"},onClick:()=>{add(),setActiveTab(`${Number(fields.length)}`)}}),onDeleteTab:v=>{remove(Number(v)),setActiveTab(""+(Number(v)-1))},onChange:v=>{setActiveTab(v)},children:fields.map((item,i)=>(0,jsx_runtime.jsx)(Tabs.A.TabPane,{title:(0,jsx_runtime.jsx)("div",{className:"capitalize",children:props.value[i]?.[tabNameKey]||"待定义"}),children:(0,jsx_runtime.jsx)(Grid.A.Row,{className:"flex-grow",gutter:16,children:Object.entries(properties)?.map(([key,filed])=>(0,react.createElement)(FromCompRender,{...filed,key,field:1===keys.length?`${item.field}`:`${item.field}.${key}`}))})},i))})})})})}TabsList.__docgenInfo={description:"",methods:[],displayName:"TabsList",props:{tabNameKey:{required:!1,tsType:{name:"string"},description:""},field:{required:!0,tsType:{name:"string"},description:""},span:{required:!0,tsType:{name:"number"},description:""},schemas:{required:!0,tsType:{name:"FormSchemas"},description:""},value:{required:!0,tsType:{name:"Array",elements:[{name:"T"}],raw:"T[]"},description:""}},composes:["Partial"]};const componentMaps={Input:Input.A,InputNumber:InputNumber.A,InputPassword:Input.A.Password,Select:Select.A,TreeSelect:TreeSelect.A,Radio:Radio.A,RadioGroup:Radio.A.Group,Checkbox:props=>(0,jsx_runtime.jsx)(Checkbox.A,{...props}),CheckboxGroup:Checkbox.A.Group,AutoComplete:AutoComplete.A,DatePicker:DatePicker.A,RangePicker:DatePicker.A.RangePicker,ColorPicker:ColorPicker.A,Cascader:props=>(0,jsx_runtime.jsx)(Cascader.A,{...props}),Switch:props=>(0,jsx_runtime.jsx)(Switch.A,{...props,checked:props.value}),InputTextArea:props=>(0,jsx_runtime.jsx)(Input.A.TextArea,{autoSize:{minRows:4},...props}),List:Form.A.List,TabsList,Void:react.Fragment},providerMaps={RequestProvider:RequestProvider.LC,Fragment:react.Fragment},FromCompRender=props=>{const{provider,compName,compProps,field,label,required,hidden,formProps}=props,ProviderComponent=provider?providerMaps[provider.compName]:null,Component=componentMaps[compName];if("List"===compName){const{schemas:{properties},hideMove,style}=compProps;return(0,jsx_runtime.jsx)(Grid.A.Col,{span:props.span||24,className:"form-list",children:(0,jsx_runtime.jsx)(Form.A.Item,{hidden,label,rules:[{required}],children:(0,jsx_runtime.jsx)(Form.A.List,{field,children:(fields,{add,remove,move})=>(0,jsx_runtime.jsxs)("div",{style:{width:"100%",...style},children:[fields.map((item,index)=>(0,jsx_runtime.jsxs)("div",{style:{display:"flex"},children:[(0,jsx_runtime.jsx)(Grid.A.Row,{className:"flex-grow",gutter:16,children:Object.entries(properties)?.map(([key,filed])=>(0,react.createElement)(FromCompRender,{...filed,key,formProps,field:1===Object.keys(properties).length?`${item.field}`:`${item.field}.${key}`}))}),(0,jsx_runtime.jsxs)("div",{style:{display:"flex",flexShrink:1},children:[!hideMove&&(0,jsx_runtime.jsx)(Button.A,{style:{marginLeft:"16px"},disabled:0===index,icon:(0,jsx_runtime.jsx)(IconArrowRise.A,{}),onClick:()=>move(index,index-1)}),!hideMove&&(0,jsx_runtime.jsx)(Button.A,{style:{marginLeft:"16px"},disabled:index+1===fields.length,icon:(0,jsx_runtime.jsx)(IconArrowFall.A,{}),onClick:()=>move(index,index+1)}),(0,jsx_runtime.jsx)(Button.A,{style:{marginLeft:"16px"},icon:(0,jsx_runtime.jsx)(IconDelete.A,{}),status:"danger",onClick:()=>remove(index)}),(0,jsx_runtime.jsx)(Button.A,{style:{marginLeft:"16px"},icon:(0,jsx_runtime.jsx)(IconPlus.A,{}),onClick:()=>add(null,index+1)})]})]},item.key)),0===fields.length&&(0,jsx_runtime.jsx)(Button.A,{className:"mb-[16px]",onClick:()=>{add()},children:"添加"})]})})})})}return"Void"===compName?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Component&&ProviderComponent?(0,jsx_runtime.jsx)(Grid.A.Col,{span:props.span||24,children:(0,jsx_runtime.jsx)(Form.A.Item,{hidden,label,field,rules:[{required}],children:(0,jsx_runtime.jsx)(ProviderComponent,{...provider?.compProps,children:(0,jsx_runtime.jsx)(RequestProvider.k_,{...provider?.injectProps,children:(0,jsx_runtime.jsx)(Component,{filed:!0,...compProps},"void")})})})}):Component?(0,jsx_runtime.jsx)(Grid.A.Col,{span:props.span||24,children:(0,jsx_runtime.jsx)(Form.A.Item,{hidden,label,field,rules:[{required}],children:(0,jsx_runtime.jsx)(Component,{placeholder:field,field,...compProps},"void")})}):(0,jsx_runtime.jsxs)("div",{children:["[COM:NAME]:",compName?.toString()]})},FormWrapperRender=props=>{const{schemas:{properties},...defaultProps}=props;return(0,jsx_runtime.jsxs)(Form.A,{...defaultProps,children:[(0,jsx_runtime.jsx)(Grid.A.Row,{gutter:[16,0],children:Object.entries(properties)?.map(([key,field])=>(0,react.createElement)(FromCompRender,{...field,key,field:key,formProps:defaultProps,label:field.label?field.label:props.comments?props.comments[key]:key}))}),defaultProps.children]})};FromCompRender.__docgenInfo={description:"",methods:[],displayName:"FromCompRender",props:{field:{required:!0,tsType:{name:"string"},description:""},formProps:{required:!1,tsType:{name:"Partial",elements:[{name:"FormProps"}],raw:"Partial<FormProps>"},description:""}}},FormWrapperRender.__docgenInfo={description:"",methods:[],displayName:"FormWrapperRender"}}}]);